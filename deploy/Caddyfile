/* Replace `yourdomain.example` with a DNS name that points to this machine's public IP.
   If you don't have a domain and must use a raw IP, see the "IP-only" section below.

   Recommended: create a DNS A record for a domain/subdomain pointing to your public IP
   and use that domain here — Caddy will obtain and renew TLS certificates automatically.
*/

yourdomain.example {
    # Serve frontend (default) and proxy API requests to backend
    reverse_proxy /api/* 127.0.0.1:8000
    reverse_proxy 127.0.0.1:5173

    # Basic logging
    log {
        output file /var/log/caddy/portal-access.log {
            roll_size 10mb
            roll_keep 5
            roll_keep_for 336h
        }
    }

    # Optional: enable simple basic auth while testing (replace user:password hash)
    # basicauth / admin JDJhJDEyJGx...   # generate with caddy hash-password
}

## IP-only configuration (no domain)
## Browsers won't trust TLS for raw IPs from Let's Encrypt. Two options:
## 1) Use Caddy's internal CA (tls internal) — works but clients must trust the Caddy CA root.
##    Replace the block above with this site block using the machine IP (e.g. 203.0.113.5):
##
## 203.0.113.5 {
##   tls internal
##   reverse_proxy /api/* 127.0.0.1:8000
##   reverse_proxy 127.0.0.1:5173
## }
##
## 2) Use a DNS name that you own and point it to the IP — preferred for public HTTPS.
